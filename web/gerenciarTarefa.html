<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gerenciar Tarefas</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>Gerenciamento de Tarefas</h1>
    <nav>
      <a href="index.html">Cadastro de Usuários</a>
      <a href="Cadastro.html">Cadastro de Tarefas</a>
      <a href="gerenciarTarefa.html">Gerenciar Tarefas</a>
    </nav>
  </header>
  <div class="container">
    <h2>Tarefas</h2>
    <div class="tarefas">
      <div class="coluna">
        <h3>A Fazer</h3>
        <div id="tarefasAFazer"></div>
      </div>
      <div class="coluna">
        <h3>Fazendo</h3>
        <div id="tarefasFazendo"></div>
      </div>
      <div class="coluna">
        <h3>Pronto</h3>
        <div id="tarefasPronto"></div>
      </div>
    </div>
  </div>

  <script>
    // Recupera as tarefas do localStorage
    const tarefas = JSON.parse(localStorage.getItem('tarefas')) || [];

    // Função para exibir as tarefas
    function exibirTarefas() {
      tarefas.forEach((tarefa, index) => {
        const tarefaDiv = document.createElement('div');
        tarefaDiv.classList.add('card');
        tarefaDiv.innerHTML = `
          <strong>Descrição:</strong> ${tarefa.descricao}<br>
          <strong>Setor:</strong> ${tarefa.setor}<br>
          <strong>Prioridade:</strong> ${tarefa.prioridade}<br>
          <strong>Vinculado a:</strong> ${tarefa.usuario}<br>
          <button onclick="editarTarefa(${index})">Editar</button> 
          <button onclick="excluirTarefa(${index})">Excluir</button><br>
          <br>
          <option>Alterar status</option>
          <button onclick="mudarStatus(${index}, 'Fazendo')">Fazendo</button>
          <button onclick="mudarStatus(${index}, 'Pronto')">Pronto</button>
        `;

        // Adiciona a tarefa na coluna correta com base no status
        if (tarefa.status === 'Fazendo') {
          document.getElementById('tarefasFazendo').appendChild(tarefaDiv);
        } else if (tarefa.status === 'Pronto') {
          document.getElementById('tarefasPronto').appendChild(tarefaDiv);
        } else {
          document.getElementById('tarefasAFazer').appendChild(tarefaDiv);
        }
      });
    }

    // Função para editar uma tarefa
    function editarTarefa(index) {
      const tarefa = tarefas[index];
      const descricao = prompt("Editar descrição:", tarefa.descricao);
      if (descricao) {
        tarefa.descricao = descricao;
        localStorage.setItem('tarefas', JSON.stringify(tarefas));
        location.reload(); // Atualiza a página para mostrar as alterações
      }
    }

    // Função para excluir uma tarefa
    function excluirTarefa(index) {
      tarefas.splice(index, 1);
      localStorage.setItem('tarefas', JSON.stringify(tarefas));
      location.reload();
    }

    // Função para mudar o status da tarefa
    function mudarStatus(index, novoStatus) {
      tarefas[index].status = novoStatus;
      localStorage.setItem('tarefas', JSON.stringify(tarefas));
      location.reload(); 
    }

    exibirTarefas();
  </script>
</body>
</html>
